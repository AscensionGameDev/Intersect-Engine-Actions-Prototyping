name: Main PR Review

on:
  pull_request_target:
    branches: [main]
  pull_request_review:


jobs:
  check-reviewers:
    if: github.event.pull_request.base.ref == 'main'
    runs-on: ubuntu-latest

    steps:
      - name: Required Review
        uses: Automattic/action-required-review@v3.0.1
        with:
          requirements-file: .github/reviewers/branch-main.yaml
          status: Review Required
          fail: true
          token: ${{ secrets.INTERSECTBOT_ACCESS_TOKEN }}

  debug:
    runs-on: ubuntu-latest

    steps:
    - name: Debug
      run: |
        echo "github.event.pull_request.base.ref=${{ github.event.pull_request.base.ref }}"
        echo "matches branch=${{ github.event.pull_request.base.ref == 'main' }}"
